- content_for :head do
  = javascript_include_tag 'jquery.tablesorter.mod'
  = javascript_include_tag 'home/spells'
- content_for :title do
  = 'Spell Book'

.container-fluid
  .menu-toggle.btn.btn-default.btn-sm{style: 'z-index: 10; display: inline-block; position: fixed; text-align: right; margin-left: 225px; margin-top: 48px'}
    = icon('chevron-left', '', id: 'menu-toggle-icon', class: 'strong')
  .row
    .center#side-menu{style: 'position: fixed; width: 240px; height: calc(100% - 50px); overflow: auto; padding-top: 10px'}
      %h4{onselectstart: 'return false', style: ''} Search
      %input.input-sm.form-control.search-box{type: 'text', style: 'margin-left: 20px; width: 200px'}
      .container-fluid
        .row
          .col-xs-6{style: 'padding-left: 0px; padding-right: 10px'}
            %h4{onselectstart: 'return false'}
              %span.toggle-all#toggle-level{'data-toggle-class': 'level-checkbox'}
                = icon('plus-square')
              Levels
            %div{onselectstart: 'return false'}
              %label.checkbox-inline
                %input.level-checkbox{type: 'checkbox', id: 'level-0', value: 0}Cantrip
              %br
              - 9.times do |i|
                %label.checkbox-inline
                  %input.level-checkbox{type: 'checkbox', id: "level-#{i+1}", value: i+1}= "#{i+1}"
                - if (i + 1) % 3 == 0
                  %br
                - else
                  %span
          .col-xs-6{style: 'padding-left: 10px; padding-right: 0px'}
            %h4{onselectstart: 'return false'}
              %span.toggle-all#toggle-vsmr{'data-toggle-class': 'vsmr-checkbox'}
                = icon('plus-square')
              V, S, M, R
            %div{onselectstart: 'return false', style: 'text-align: left; margin-left: 40px'}
              %label.checkbox-inline
                %input.vsmr-checkbox{type: 'checkbox', id: 'vmsr-v', value: 'v'} V
              %br
              %label.checkbox-inline
                %input.vsmr-checkbox{type: 'checkbox', id: 'vmsr-s', value: 's'} S
              %br
              %label.checkbox-inline
                %input.vsmr-checkbox{type: 'checkbox', id: 'vmsr-m', value: 'm'} M
              %br
              %label.checkbox-inline
                %input.vsmr-checkbox{type: 'checkbox', id: 'vmsr-r', value: 'r'} R
      %br
      %h4{onselectstart: 'return false'}
        %span.toggle-all#toggle-school{'data-toggle-class': 'school-checkbox'}
          = icon('plus-square')
        Schools
      %div{style: 'text-align: left; margin-left: 10px; margin-right: 41px', onselectstart: 'return false'}
        - @schools.each_slice(2) do |schools|
          .row
            - schools.each do |school|
              .col-xs-6
                %label.checkbox-inline
                  %input.school-checkbox{type: 'checkbox', id: "school-#{school}", value: school}= school
      %br
      %h4{onselectstart: 'return false'}
        %span.toggle-all#toggle-class{'data-toggle-class': 'class-checkbox'}
          = icon('plus-square')
        Classes
      %div{style: 'text-align: left; margin-left: 23px; margin-right: 18px', onselectstart: 'return false'}
        - @classes.each_slice(2) do |dnd_classes|
          .row
            - dnd_classes.each do |dnd_class|
              .col-xs-6
                %label.checkbox-inline
                  %input.class-checkbox{type: 'checkbox', id: "class-#{dnd_class}", value: dnd_class}= dnd_class
      %br
      %span.spell-count
        0 spells
    .container-fluid#main-content{style: 'height: 100%; overflow: auto; margin-left: 260px; margin-right: 20px'}
      = render 'layouts/notice_div'

      .alert.center.save-update-message#save-update-success-message{style: 'margin-top: 15px; display: none', class: bootstrap_class_for(:success)}
        %button.close{'data-hide': 'alert'} ×
        %span Successfully saved your spell list.

      .alert.center.save-update-message#save-update-fail-message{style: 'margin-top: 15px; display: none', class: bootstrap_class_for(:error)}
        %button.close{'data-hide': 'alert'} ×
        %span Failed to save your spell list.
      .row
        .col-xs-2{style: 'padding-top: 20px'}
          .btn.btn-success.save-button#save-new{style: "#{'display: none' unless @spell_code}"}= "Save#{' as new' if @spell_code}"
          %br
          .btn.btn-info.save-button#save-update{style: "#{'display: none' unless @spell_code}"} Update
        .col-xs-8
          %h1{style: 'margin-bottom: 10px'} Spell Book
          %h2#spell-code{style: "margin-top: 0; margin-bottom: 10px; #{'display: none' unless @spell_code}"}= @spell_code || ''
      %table.full-table.table{style: 'margin-top: 30px'}
        %thead
          %tr
            %th.expand-header
            %th{style: 'white-space: nowrap'}
              = icon('star', '')
              = icon('sort', '', class: 'sort-icon glyph-grey')
            - ['Name', 'Level', 'School', 'Classes', 'V', 'S', 'M', 'R', 'Range', 'Duration', 'Casting Time'].each_with_index do |header, index|
              %th{style: 'white-space: nowrap'}
                = header
                - if index < 8
                  = icon('sort', '', class: 'sort-icon glyph-grey')
        %tbody
          - @spells.each do |id, spell|
            %tr.summary.summary-visible{'data-id': id, 'data-name': spell['name'], 'data-level': spell['level'], 'data-school': spell['school'], 'data-classes': spell['classes'], 'data-vsmr': [spell['v'], spell['s'], spell['m'], spell['r']]}
              %td.expand{onselectstart: 'return false'}
                %span.glyphicon.glyphicon-resize-full
              %td
                - if spell.has_key? 'starred'
                  %i.starable.fa.fa-star
                - else
                  %i.starable.fa.fa-star-o
              %td= spell['name']
              %td{style: 'text-align: center'}= spell['level'] == 0 ? 'Cantrip' : spell['level']
              %td= spell['school']
              %td= spell['classes'].sort.join(', ')
              %td{style: 'text-align: center'}
                %span.glyphicon{class: "glyphicon-#{spell['v'] ? 'ok' : 'remove'}"}
              %td{style: 'text-align: center'}
                %span.glyphicon{class: "glyphicon-#{spell['s'] ? 'ok' : 'remove'}"}
              %td{style: 'text-align: center'}
                %span.glyphicon{class: "glyphicon-#{spell['m'] ? 'ok' : 'remove'}"}
              %td{style: 'text-align: center'}
                %span.glyphicon{class: "glyphicon-#{spell['r'] ? 'ok' : 'remove'}"}
              %td= spell['range']
              %td= spell['duration']
              %td= spell['casting_time']
            %tr.details.details-display-none
              %td{colspan: 13}
                %table.table.details-table{style: 'background-color: #e7e7e8'}
                  %tr
                    - if spell['m']
                      %td{style: 'width: 30%'}
                        %h5 Material
                        = spell['material']
                    %td
                      %h5 Short Description
                      %p= spell['short_description']
                  %tr
                    %td{colspan: spell['m'] ? 2 : 1}
                      %h5 Description
                      = spell['description']
      = render 'layouts/footer'
      = debug(params) if Rails.env.development?
